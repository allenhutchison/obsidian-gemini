You are analyzing an Obsidian vault to generate or update context for the AGENTS.md file.
This file will provide persistent context to AI agents about the vault's structure,
organization, key topics, and purpose.

{{#if existingContent}}
## Existing AGENTS.md Content

The vault already has an AGENTS.md file with the following content:

```
{{{existingContent}}}
```

Your task is to analyze the vault structure and content provided, then UPDATE the existing
AGENTS.md content by:
- Preserving any user customizations or specific details they've added
- Filling in sections that are empty or contain placeholder text
- Enhancing existing content with new insights from your vault analysis
- Updating outdated information based on current vault state
- Merging your observations with what's already documented

{{else}}
Your task is to analyze the vault structure and content provided to you and generate
comprehensive, helpful content for each of the following sections.
{{/if}}

## Instructions

1. **Vault Overview**: Provide a 2-3 sentence description of what this vault appears to
   be used for based on the folder structure, file names, and any content you can see.
   Be specific about the domain or purpose (e.g., "personal knowledge base for software
   development", "research vault for academic papers on machine learning", "project
   management for a startup", etc.).

   Format as 1-2 short paragraphs with proper line breaks between sentences if needed.

2. **Organization**: Describe how the vault is organized. Include:
   - Main folder structure and what each folder contains
   - Any obvious organizational patterns (by topic, by date, by project, etc.)
   - How notes appear to be linked or connected
   - Any special organizational schemes you notice (MOCs, daily notes, zettelkasten, etc.)

   Format as 2-3 paragraphs with proper spacing. Use bullet points where appropriate for
   listing folders or organizational patterns.

3. **Key Topics**: List the main topics or themes present in this vault. These should be:
   - Specific and concrete (not generic)
   - Based on actual folder names, file names, and content
   - Organized by importance or frequency
   - Formatted as a bulleted list with proper spacing

   Use a clear bulleted list format with one topic per line.

4. **User Preferences**: Based on the writing style, note structure, and organization,
   infer any preferences the user has for how the agent should behave. This might include:
   - Preferred writing style (formal vs. casual)
   - Level of detail in responses
   - Preferred note-taking patterns
   - Any obvious conventions to follow

   Format as 2-3 short paragraphs. If you cannot infer clear preferences, write:
   "(Preferences will be learned over time)"

5. **Custom Instructions**: Based on the vault's purpose and organization, suggest any
   vault-specific instructions for the agent. For example:
   - Special handling for certain types of notes
   - Conventions for linking or tagging
   - Any domain-specific knowledge that would be helpful

   Format as bullet points or short paragraphs. If no specific instructions are needed, write:
   "(No specific instructions yet)"

## Output Format

Return your analysis as a JSON object with the following structure:

```json
{
  "vaultOverview": "...",
  "organization": "...",
  "keyTopics": "...",
  "userPreferences": "...",
  "customInstructions": "..."
}
```

Each field should contain well-formatted Markdown text with:
- Proper paragraph breaks (use `\n\n` for paragraph spacing)
- Bullet points where appropriate (use `- ` for lists)
- Emphasis markers where helpful (use `**bold**` or `*italic*`)
- Clear structure and readability

The content should be helpful and specific to this vault, not generic boilerplate.
IMPORTANT: Use actual newline characters (`\n`) in your JSON strings for proper formatting.

## Important Guidelines

- Be specific and concrete - avoid generic statements
- Base your analysis on actual evidence from the vault
- If information is limited, acknowledge that and provide what you can
- Write from the perspective of helping future AI agents understand this vault
- Use proper Markdown formatting for readability
- Keep descriptions concise but informative

{{> languageInstruction}}
{{#if existingContent}}
- When updating existing content, preserve the user's voice and specific customizations
- Only update sections that need updating based on new vault analysis
- If existing content is already good, keep it rather than replacing with generic text
- Mark sections that couldn't be analyzed with appropriate notes (e.g., "No changes needed")
{{/if}}

Now analyze the vault structure and content provided below and {{#if existingContent}}update{{else}}generate{{/if}} the AGENTS.md content.
